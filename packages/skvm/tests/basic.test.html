<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body style="padding: 200px">
    test js run time
    <div></div>
    <button id="run">run</button>
  </body>
  <script type="module">
    import init, { evaluate } from '../pkg/web/skvm.js';

    init().then(() => {
      document.querySelector('#run').addEventListener('click', () => {
        const res = evaluate(
          [
            `
        
        function testcc () {
          let bn = {a: 11n, b: 111111111n,c:66562555555n,d:5458452115n,r:55555555555555n};
          let bns = JSON.stringify(bn);
          __sk_utils__.log(bns)
          __sk_utils__.save_storage(bns)
          let str = '{"a": 1n}'
          const a= JSON.parse(bns);
          __sk_utils__.log(a.a)
          __sk_utils__.log(a.a === 11)
          __sk_utils__.log(a.a === 11n)

          __sk_utils__.log(__sk_utils__.storage)

        let num = Math.random()
        if (num > 0.5) {
            return 1
        } else {
            return 2
        }
    }
        `,
            'testcc()',
          ].reverse(),
          1000n,
          new Uint8Array([
            123, 34, 97, 34, 58, 49, 49, 110, 44, 34, 98, 34, 58, 49, 49, 49,
            49, 49, 49, 49, 49, 110, 44, 34, 99, 34, 58, 54, 54, 53, 54, 50, 53,
            53, 53, 53, 110, 44, 34, 100, 34, 58, 53, 52, 53, 56, 52, 53, 50,
            49, 49, 53, 110, 44, 34, 114, 34, 58, 53, 53, 53, 53, 53, 53, 53,
            53, 53, 53, 53, 53, 53, 53, 53, 125,
          ]),
        );
        console.log(res);
      });
    });
  </script>
</html>
